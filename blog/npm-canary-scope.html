<!DOCTYPE html><html lang="en"><head><style>
            :root {
              --color-primary-100: #F3E6ED;
              --color-primary-200: #E1BFD1;
              --color-primary-300: #CF99B6;
              --color-primary-400: #AB4D7F;
              --color-primary-500: #870048;
              --color-primary-600: #7A0041;
              --color-primary-700: #51002B;
              --color-primary-800: #3D0020;
              --color-primary-900: #290016;

              --color-gray-100: #f6f7f5;
              --color-gray-200: #eaeae7;
              --color-gray-300: #dcd5d4;
              --color-gray-400: #c2bdbd;
              --color-gray-500: #9f9697;
              --color-gray-600: #706a69;
              --color-gray-700: #534e4f;
              --color-gray-800: #3c383b;
              --color-gray-900: #2e2c2f;
              --color-gray-1000: #181517;
            }
          </style><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-142981718-4"></script><script>
                window.dataLayer = window.dataLayer || [];

                function gtag() { dataLayer.push(arguments) }

                gtag('js', new Date());
                gtag('config', 'UA-142981718-4', {
                  anonymize_ip: true,
                  page_path: window.location.pathname,
                });
              </script><meta name="viewport" content="width=device-width"><meta charset="utf-8"><meta name="description" content="Depending on the build platform you might be able to pass secrets to PR builds for forked repos.
While this makes the developer experience of your project nice, in `auto`'s case publishing canary versions, it exposes your keys.
"><meta property="og:url" content="https://intuit.github.io/auto/blog/npm-canary-scope"><meta property="og:type" content="website"><meta property="og:title" content="npm: More Secure Canary Publishing"><meta name="og:description" content="Depending on the build platform you might be able to pass secrets to PR builds for forked repos.
While this makes the developer experience of your project nice, in `auto`'s case publishing canary versions, it exposes your keys.
"><meta name="og:image" content="https://images.unsplash.com/photo-1566386087068-55645996b234?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=500&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=1950"><meta property="twitter:domain" content="intuit.github.io"><meta property="twitter:url" content="https://intuit.github.io/auto/blog/npm-canary-scope"><meta name="twitter:title" content="npm: More Secure Canary Publishing"><meta name="twitter:description" content="Depending on the build platform you might be able to pass secrets to PR builds for forked repos.
While this makes the developer experience of your project nice, in `auto`'s case publishing canary versions, it exposes your keys.
"><meta name="twitter:image" content="https://images.unsplash.com/photo-1566386087068-55645996b234?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=500&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=1950"><link rel="shortcut icon" media="(prefers-color-scheme:dark)" href="/auto/favicon.png"><title>npm: More Secure Canary Publishing</title><meta property="og:type" content="article"><meta name="next-head-count" content="16"><link rel="preload" href="/auto/_next/static/css/38cf56bb8f79d15e8343.css" as="style"><link rel="stylesheet" href="/auto/_next/static/css/38cf56bb8f79d15e8343.css" data-n-g=""><link rel="preload" href="/auto/_next/static/css/b2a6d9973598118e01a9.css" as="style"><link rel="stylesheet" href="/auto/_next/static/css/b2a6d9973598118e01a9.css" data-n-g=""><noscript data-n-css=""></noscript><link rel="preload" href="/auto/_next/static/chunks/main-f6532be1535b198c60f4.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/framework.4e17f312d9f9b3aad38a.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/c0d60241.15909a4bc03a7108ef04.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/7099324e.3bbe0c84743f3f8d6181.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/60de19c75837512d55b9404a5db8396b6717d947.d65b136bc73a15f931c4.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/407b68a2c164b6b9b6a4d40d42a4d74dc6267618.dcd964a49a4df3e8b4c5.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/b87c9fd761b4c97a46b67e1dfa68ac2b7826d06a.d1b1308e17938dccf052.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/ffd4daddbb32ad1e02d714eb0ba3bd454f8be05f.05d3922760540533f108.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/71247caf95475e3ea7f9a0f8a30beb258b23d005.cfdabd25e11f0be40970.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/pages/_app-5ba64146854c56cf041a.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/fad10ed4fe30e9b4290d0f5f822e85f2fbd13176.e6ba2a6a7dcda3e2075b.js" as="script"><link rel="preload" href="/auto/_next/static/chunks/pages/blog/npm-canary-scope-65251613bb791e63ff20.js" as="script"><meta name="apple-mobile-web-app-capable" content="yes">

<link rel="apple-touch-icon" href="/auto/apple-icon-180.png">

<link rel="apple-touch-startup-image" href="/auto/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">

<meta name="apple-mobile-web-app-capable" content="yes">

<link rel="apple-touch-icon" href="/auto/apple-icon-180.png">

<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2048-2732.jpg" media="(prefers-color-scheme: dark) and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2732-2048.jpg" media="(prefers-color-scheme: dark) and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1668-2388.jpg" media="(prefers-color-scheme: dark) and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2388-1668.jpg" media="(prefers-color-scheme: dark) and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1536-2048.jpg" media="(prefers-color-scheme: dark) and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2048-1536.jpg" media="(prefers-color-scheme: dark) and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1668-2224.jpg" media="(prefers-color-scheme: dark) and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2224-1668.jpg" media="(prefers-color-scheme: dark) and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1620-2160.jpg" media="(prefers-color-scheme: dark) and (device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2160-1620.jpg" media="(prefers-color-scheme: dark) and (device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1284-2778.jpg" media="(prefers-color-scheme: dark) and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2778-1284.jpg" media="(prefers-color-scheme: dark) and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1170-2532.jpg" media="(prefers-color-scheme: dark) and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2532-1170.jpg" media="(prefers-color-scheme: dark) and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1125-2436.jpg" media="(prefers-color-scheme: dark) and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2436-1125.jpg" media="(prefers-color-scheme: dark) and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1242-2688.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2688-1242.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-828-1792.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1792-828.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1242-2208.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-2208-1242.jpg" media="(prefers-color-scheme: dark) and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-750-1334.jpg" media="(prefers-color-scheme: dark) and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1334-750.jpg" media="(prefers-color-scheme: dark) and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-640-1136.jpg" media="(prefers-color-scheme: dark) and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
<link rel="apple-touch-startup-image" href="/auto/apple-splash-dark-1136-640.jpg" media="(prefers-color-scheme: dark) and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">

      <meta name="application-name" content="auto">
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-status-bar-style" content="default">
      <meta name="apple-mobile-web-app-title" content="auto">
      <meta name="format-detection" content="telephone=no">
      <meta name="mobile-web-app-capable" content="yes">

      <meta name="msapplication-tap-highlight" content="no">
      <meta name="twitter:card" content="summary">
      <meta property="og:site_name" content="auto">
      <meta name="theme-color" content="#7A0041">
      <meta name="msapplication-TileColor" content="#7A0041">
      <link rel="manifest" href="/auto/manifest.json">
    </head><body><div id="__next"><a href="#reach-skip-nav" data-reach-skip-link="" data-reach-skip-nav-link="">Skip to content</a><div id="ignite" class="min-h-screen flex flex-col bg-white dark:bg-gray-1000"><div class="sticky top-0 z-40 border-b border-gray-200 lg:mx-0 bg-white dark:bg-gray-1000 dark:border-gray-800"><div class="h-16 max-w-6xl mx-auto w-full flex justify-between items-center"><a tabindex="0" class="text-gray-800 dark:text-gray-300 px-6 h-full focus:outline-none focus-visible:ring ring-inset rounded flex items-center font-normal cursor-pointer text-xl md:pr-10 lg:w-60 xl:w-72" href="/auto/index"><picture class="md:mr-3"><source srcset="/auto/logo-dark.svg" media="(prefers-color-scheme: dark)" class="w-8 h-8"><img src="/auto/logo.svg" alt="auto Logo" class="w-8 h-8"></picture><span class="hidden uppercase font-semibold tracking-widest text-sm md:block dark:text-gray-200">auto</span></a><div class="w-full h-full flex items-center lg:flex flex-1 lg:pl-12 lg:pr-6 lg:mx-auto"><div class="h-full flex items-center w-full lg:w-auto lg:flex-1 lg:mr-4 lg:pr-4"><div class="w-full lg:relative"><div class="w-full relative"><input id="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search (Press &quot;/&quot; to focus)" class="text-gray-800 dark:text-gray-300 placeholder-gray-500 rounded border-2 border-gray-200 bg-gray-200 px-4 py-2 w-full focus:bg-white focus:outline-none dark:focus:bg-gray-1000 dark:focus:border-gray-800 dark:focus:text-white dark-placeholder:placeholder-gray-600 dark:bg-gray-900 dark:border-gray-900" value=""></div></div></div><button class="text-gray-700 px-6 hover:text-primary-600 focus:text-primary-600 focus:outline-none dark:text-gray-400 lg:hidden"><svg class="fill-current w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button><div class="hidden lg:flex h-full"><a tabindex="0" class="justify-center h-full flex items-center px-6 py-4 cursor-pointer text-gray-700 hover:bg-gray-200 hover:text-primary-600 focus:bg-gray-200 focus:text-primary-600 focus:outline-none focus-visible:ring ring-inset dark:text-gray-400 dark:hover:bg-gray-900 dark:hover:text-white dark:focus:bg-gray-1000 dark:focus:text-white" href="/auto/docs"><div class="flex items-center">Docs</div></a><a tabindex="0" class="justify-center h-full flex items-center px-6 py-4 cursor-pointer text-gray-700 hover:bg-gray-200 hover:text-primary-600 focus:bg-gray-200 focus:text-primary-600 focus:outline-none focus-visible:ring ring-inset dark:text-gray-400 dark:hover:bg-gray-900 dark:hover:text-white dark:focus:bg-gray-1000 dark:focus:text-white" href="/auto/blog"><div class="flex items-center">Blog</div></a><a tabindex="0" class="justify-center h-full flex items-center px-6 py-4 cursor-pointer text-gray-700 hover:bg-gray-200 hover:text-primary-600 focus:bg-gray-200 focus:text-primary-600 focus:outline-none focus-visible:ring ring-inset dark:text-gray-400 dark:hover:bg-gray-900 dark:hover:text-white dark:focus:bg-gray-1000 dark:focus:text-white" href="https://github.com/intuit/auto" target="_blank" aria-label="Open on GitHub"><div class="flex items-center"><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M10 0a10 10 0 0 0-3.16 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94 0-1.1.39-1.99 1.03-2.69a3.6 3.6 0 0 1 .1-2.64s.84-.27 2.75 1.02a9.58 9.58 0 0 1 5 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69 0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0 0 10 0"></path></svg></div></a></div></div></div></div><div id="reach-skip-nav" data-reach-skip-nav-content=""></div><div class="bg-primary-500 bg-cover bg-no-repeat bg-center h-screen" style="max-height:30vh;min-height:315px;background-image:url(https://images.unsplash.com/photo-1566386087068-55645996b234?crop=entropy&amp;cs=tinysrgb&amp;fit=crop&amp;fm=jpg&amp;h=500&amp;ixid=eyJhcHBfaWQiOjF9&amp;ixlib=rb-1.2.1&amp;q=80&amp;w=1950)"></div><article class="DocSearch-content blog-post pt-6 pb-12 px-6 mx-4 rounded-xl -mt-10 mb-16 bg-white shadow-md text-gray-800 lg:max-w-screen-md lg:mx-auto lg:w-full dark:bg-gray-900 border dark:border-gray-500"><div class="mx-auto text-center flex flex-col items-center"><img src="//www.gravatar.com/avatar/ff725a631f869cdb78beeb003825bb40" class="rounded-full border-2 border-gray-200 dark:border-gray-900 w-12 h-12 -mt-12 mb-4"><h1 class="lvl1 text-3xl font-light mb-2 lg:mb-4 dark:text-gray-200">npm: More Secure Canary Publishing</h1><p class="mb-6"><span class="dark:text-gray-300">Andrew Lisowski</span> <time class="text-gray-600 dark:text-gray-500" datetime="Thu, 12 Mar 2020 23:00:02 -0700">on <!-- -->Mar 12, 2020</time></p></div><p class="my-4 text-gray-800 dark:text-gray-300">Publishing canary versions comes with some security risks.
If your project is private you have nothing to worry about, but if your project is open source there are some security holes.</p><h2 class="lvl2 break-words relative text-2xl font-normal border-b border-gray-300 pb-2 mb-4 mt-6 md:mb-6 lg:text-3xl lg:mt-8 mb:pb-4 dark:border-gray-700 text-gray-900 dark:text-gray-200" id="attack-vectors"><a class="focus-visible:ring ring-offset-2 focus:outline-none rounded header-link no-underline text-gray-900&quot; hover:underline" href="#attack-vectors">Attack Vectors</a></h2><p class="my-4 text-gray-800 dark:text-gray-300">Depending on the build platform you might be able to pass secrets to PR builds for forked repos.
While this makes the developer experience of your project nice, in <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto</code>'s case publishing canary versions, it exposes your keys.</p><p class="my-4 text-gray-800 dark:text-gray-300">An attacker could:</p><ol class="my-6 ol"><li class="my-4 text-gray-800 dark:text-gray-300">print secrets</li><li class="my-4 text-gray-800 dark:text-gray-300">send secrets to some server</li><li class="my-4 text-gray-800 dark:text-gray-300">modify <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto</code> to publish to the latest tag instead of <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">canary</code></li></ol><p class="my-4 text-gray-800 dark:text-gray-300">No amount of code can fix these problems.
If your release keys are in everyone's CI builds an attacker can do any number of things to modify what you intend for <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto</code> to do (or any other release method run in the CI).</p><h2 class="lvl2 break-words relative text-2xl font-normal border-b border-gray-300 pb-2 mb-4 mt-6 md:mb-6 lg:text-3xl lg:mt-8 mb:pb-4 dark:border-gray-700 text-gray-900 dark:text-gray-200" id="solution"><a class="focus-visible:ring ring-offset-2 focus:outline-none rounded header-link no-underline text-gray-900&quot; hover:underline" href="#solution">Solution</a></h2><p class="my-4 text-gray-800 dark:text-gray-300">The solution for this is actually quite simple:</p><ol class="my-6 ol"><li class="my-4 text-gray-800 dark:text-gray-300">Create a test scope that you publish canaries under (ex: <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">@auto-canary</code> or <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">@auto-test</code>)</li><li class="my-4 text-gray-800 dark:text-gray-300">Create a user that only has access to that scope</li><li class="my-4 text-gray-800 dark:text-gray-300">Set the default <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">NPM_TOKEN</code> to a token that can publish to that scope (this is used for any pull request)</li><li class="my-4 text-gray-800 dark:text-gray-300">Set up a <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">secure</code> token that is only accessible on the main fork (still named <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">NPM_TOKEN</code>)</li></ol><p class="my-4 text-gray-800 dark:text-gray-300">Step 3 might not be possible on your build platform.</p><p class="my-4 text-gray-800 dark:text-gray-300">The following are the ways the <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto</code> team knows how to do it.
If you do not see the method for you build platform, please make a pull request!</p><ul class="my-6 ul"><li class="my-4 text-gray-800 dark:text-gray-300"><a class="underline cursor-pointer text-gray-800 dark:text-gray-300 focus:outline-none focus-visible:ring" href="https://circleci.com/docs/2.0/contexts/">CircleCI Context</a> - Contexts provide a mechanism for securing and sharing environment variables across projects. The environment variables are defined as name/value pairs and are injected at runtime.</li></ul><h2 class="lvl2 break-words relative text-2xl font-normal border-b border-gray-300 pb-2 mb-4 mt-6 md:mb-6 lg:text-3xl lg:mt-8 mb:pb-4 dark:border-gray-700 text-gray-900 dark:text-gray-200" id="usage"><a class="focus-visible:ring ring-offset-2 focus:outline-none rounded header-link no-underline text-gray-900&quot; hover:underline" href="#usage">Usage</a></h2><p class="my-4 text-gray-800 dark:text-gray-300">To use this work flow in <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto</code>, supply the following configuration to the <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">npm</code> plugin.</p><pre class="bg-gray-200 rounded border my-6 dark:bg-gray-800 dark:border-gray-700" style="margin-top:1.5rem;margin-bottom:1.5rem"><code class="language-json syntax-light text-gray-600 rounded block py-8 px-6 overflow-auto dark:bg-gray-800" style="background:#fff"><span style="color:#24292E">{</span>
<span style="color:#24292E">  </span><span style="color:#005CC5">"plugins"</span><span style="color:#24292E">: [</span>
<span style="color:#24292E">    [</span>
<span style="color:#24292E">      </span><span style="color:#032F62">"npm"</span><span style="color:#24292E">,</span>
<span style="color:#24292E">      {</span>
<span style="color:#24292E">        </span><span style="color:#005CC5">"canaryScope"</span><span style="color:#24292E">: </span><span style="color:#032F62">"@auto-canary"</span>
<span style="color:#24292E">      }</span>
<span style="color:#24292E">    ]</span>
<span style="color:#24292E">  ]</span>
<span style="color:#24292E">}</span>
</code><code class="language-json syntax-light syntax-dark text-gray-600 rounded block py-8 px-6 overflow-auto dark:bg-gray-800" style="background:#24292e"><span style="color:#E1E4E8">{</span>
<span style="color:#E1E4E8">  </span><span style="color:#79B8FF">"plugins"</span><span style="color:#E1E4E8">: [</span>
<span style="color:#E1E4E8">    [</span>
<span style="color:#E1E4E8">      </span><span style="color:#9ECBFF">"npm"</span><span style="color:#E1E4E8">,</span>
<span style="color:#E1E4E8">      {</span>
<span style="color:#E1E4E8">        </span><span style="color:#79B8FF">"canaryScope"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"@auto-canary"</span>
<span style="color:#E1E4E8">      }</span>
<span style="color:#E1E4E8">    ]</span>
<span style="color:#E1E4E8">  ]</span>
<span style="color:#E1E4E8">}</span>
</code></pre><p class="my-4 text-gray-800 dark:text-gray-300">Now when people make pull requests to your repos:</p><ol class="my-6 ol"><li class="my-4 text-gray-800 dark:text-gray-300">your CI can run <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">auto shipit</code></li><li class="my-4 text-gray-800 dark:text-gray-300">the canary versions will get published under your <code class="text-gray-700 bg-gray-200 rounded dark:bg-gray-800 dark:text-gray-200" style="padding:2px 6px">canaryScope</code></li></ol></article><div id="disqus_thread" class="px-6 lg:max-w-screen-md lg:mx-auto w-full mb-16 lg:mb-28"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blog/npm-canary-scope","query":{},"buildId":"FfhV5SosHF2eheoP7nahF","assetPrefix":"/auto","runtimeConfig":{"assetPrefix":"/auto"},"nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/auto/_next/static/chunks/polyfills-399cf07557b47c6b7ddb.js"></script><script src="/auto/_next/static/chunks/main-f6532be1535b198c60f4.js" async=""></script><script src="/auto/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/auto/_next/static/chunks/framework.4e17f312d9f9b3aad38a.js" async=""></script><script src="/auto/_next/static/chunks/c0d60241.15909a4bc03a7108ef04.js" async=""></script><script src="/auto/_next/static/chunks/7099324e.3bbe0c84743f3f8d6181.js" async=""></script><script src="/auto/_next/static/chunks/60de19c75837512d55b9404a5db8396b6717d947.d65b136bc73a15f931c4.js" async=""></script><script src="/auto/_next/static/chunks/407b68a2c164b6b9b6a4d40d42a4d74dc6267618.dcd964a49a4df3e8b4c5.js" async=""></script><script src="/auto/_next/static/chunks/b87c9fd761b4c97a46b67e1dfa68ac2b7826d06a.d1b1308e17938dccf052.js" async=""></script><script src="/auto/_next/static/chunks/ffd4daddbb32ad1e02d714eb0ba3bd454f8be05f.05d3922760540533f108.js" async=""></script><script src="/auto/_next/static/chunks/71247caf95475e3ea7f9a0f8a30beb258b23d005.cfdabd25e11f0be40970.js" async=""></script><script src="/auto/_next/static/chunks/pages/_app-5ba64146854c56cf041a.js" async=""></script><script src="/auto/_next/static/chunks/fad10ed4fe30e9b4290d0f5f822e85f2fbd13176.e6ba2a6a7dcda3e2075b.js" async=""></script><script src="/auto/_next/static/chunks/pages/blog/npm-canary-scope-65251613bb791e63ff20.js" async=""></script><script src="/auto/_next/static/FfhV5SosHF2eheoP7nahF/_buildManifest.js" async=""></script><script src="/auto/_next/static/FfhV5SosHF2eheoP7nahF/_ssgManifest.js" async=""></script></body></html>